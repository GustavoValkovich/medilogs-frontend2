"use strict";(self.webpackChunkmedilogs_frontend=self.webpackChunkmedilogs_frontend||[]).push([[388],{6388:(W,k,l)=>{l.r(k),l.d(k,{PacientesModule:()=>Y});var v=l(177),r=l(9417),p=l(9012),c=l(9159),E=l(6440),h=l(2042),t=l(4438),_=l(1626),j=l(6354);let b=(()=>{class i{constructor(e){this.http=e,this.base="http://localhost:3000/api"}authHeaders(){const e=localStorage.getItem("medilogs_token");return e?{headers:new _.Lr({Authorization:`Bearer ${e}`})}:{}}getPacientes(){return this.http.get(`${this.base}/patients`).pipe((0,j.T)(e=>e.map(n=>this.normalizePacienteFromApi(n))))}getPaciente(e){return this.http.get(`${this.base}/patients/${e}`).pipe((0,j.T)(n=>this.normalizePacienteFromApi(n)))}createPaciente(e){return this.http.post(`${this.base}/patients`,e)}createHistoria(e,n){return this.http.post(`${this.base}/consultations`,{pacienteId:e,...n},this.authHeaders())}normalizePacienteFromApi(e){const n=e.full_name||null;let o="",a="";if(n){const u=n.trim().split(/\s+/);o=u.shift()||"",a=u.join(" ")||""}else e.email&&(o=String(e.email).split("@")[0]);let s=0;if(e.birth_date){const u=new Date(e.birth_date);if(!isNaN(u.getTime())){const F=Date.now()-u.getTime();s=Math.floor(F/315576e5)}}return{id:e.id,nombre:o,apellido:a,edad:s,dni:e.document||e.dni||void 0,obraSocial:e.insurance||e.obraSocial||void 0,telefono:e.phone||e.telefono||void 0,email:e.email||void 0,domicilio:e.city||e.domicilio||void 0}}static{this.\u0275fac=function(n){return new(n||i)(t.KVO(_.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var g=l(9631),d=l(6467),f=l(8834),T=l(9213),C=l(5596),S=l(5911);const N=()=>[5,10,25];function y(i,m){1&i&&(t.j41(0,"th",21),t.EFF(1,"Nombre"),t.k0s())}function L(i,m){if(1&i&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.R7$(),t.JRh(e.nombre)}}function M(i,m){1&i&&(t.j41(0,"th",21),t.EFF(1,"Apellido"),t.k0s())}function D(i,m){if(1&i&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.R7$(),t.JRh(e.apellido)}}function R(i,m){1&i&&(t.j41(0,"th",21),t.EFF(1,"Edad"),t.k0s())}function $(i,m){if(1&i&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.R7$(),t.JRh(e.edad)}}function G(i,m){1&i&&(t.j41(0,"th",21),t.EFF(1,"Obra Social"),t.k0s())}function H(i,m){if(1&i&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.R7$(),t.JRh(e.obraSocial)}}function O(i,m){1&i&&(t.j41(0,"th",21),t.EFF(1,"Email"),t.k0s())}function A(i,m){if(1&i&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.R7$(),t.JRh(e.email)}}function B(i,m){1&i&&(t.j41(0,"th",23),t.EFF(1,"Acciones"),t.k0s())}function w(i,m){if(1&i){const e=t.RV6();t.j41(0,"td",22)(1,"button",24),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.seleccionar(o))}),t.j41(2,"mat-icon"),t.EFF(3,"chevron_right"),t.k0s()()()}}function U(i,m){1&i&&t.nrm(0,"tr",25)}function V(i,m){if(1&i){const e=t.RV6();t.j41(0,"tr",26),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.seleccionar(o))}),t.k0s()}}let X=(()=>{class i{constructor(e,n){this.pacienteService=e,this.router=n,this.displayedColumns=["nombre","apellido","edad","obraSocial","email","acciones"],this.dataSource=new c.I6([]),this.filtroNombre="",this.filtroApellido="",this.filtroEdad=null,this.filtroObra=""}ngOnInit(){this.load()}load(){this.pacienteService.getPacientes().subscribe(e=>{this.dataSource.data=e,setTimeout(()=>{this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort)})})}aplicarFiltros(){const e=(this.filtroNombre||"").trim().toLowerCase(),n=(this.filtroApellido||"").trim().toLowerCase(),o=this.filtroEdad,a=(this.filtroObra||"").trim().toLowerCase();this.dataSource.filterPredicate=(s,u)=>{const F=!e||s.nombre.toLowerCase().includes(e),Q=!n||s.apellido.toLowerCase().includes(n),K=null==o||s.edad===o,Z=!a||(s.obraSocial||"").toLowerCase().includes(a);return F&&Q&&K&&Z},this.dataSource.filter=Math.random().toString()}limpiarFiltros(){this.filtroNombre="",this.filtroApellido="",this.filtroEdad=null,this.filtroObra="",this.aplicarFiltros()}nuevoPaciente(){this.router.navigate(["/pacientes/nuevo"])}seleccionar(e){e.id&&this.router.navigate(["/pacientes",e.id,"historia"])}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(b),t.rXU(p.Ix))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-pacientes-list"]],viewQuery:function(n,o){if(1&n&&(t.GBs(E.iy,5),t.GBs(h.B4,5)),2&n){let a;t.mGM(a=t.lsd())&&(o.paginator=a.first),t.mGM(a=t.lsd())&&(o.sort=a.first)}},decls:49,vars:9,consts:[[2,"flex","1 1 auto"],["mat-flat-button","","color","primary",3,"click"],[2,"display","flex","gap","12px","padding","12px","flex-wrap","wrap"],["appearance","fill"],["matInput","",3,"ngModelChange","ngModel"],["matInput","","type","number",3,"ngModelChange","ngModel"],["mat-button","",3,"click"],[2,"padding","12px"],["mat-table","","matSort","",1,"mat-elevation-z8",2,"width","100%",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","apellido"],["matColumnDef","edad"],["matColumnDef","obraSocial"],["matColumnDef","email"],["matColumnDef","acciones"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","style","cursor:pointer",3,"click",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row","",2,"cursor","pointer",3,"click"]],template:function(n,o){1&n&&(t.j41(0,"mat-card")(1,"mat-toolbar")(2,"span"),t.EFF(3,"Pacientes"),t.k0s(),t.nrm(4,"span",0),t.j41(5,"button",1),t.bIt("click",function(){return o.nuevoPaciente()}),t.EFF(6,"Nuevo Paciente"),t.k0s()(),t.j41(7,"div",2)(8,"mat-form-field",3)(9,"mat-label"),t.EFF(10,"Nombre"),t.k0s(),t.j41(11,"input",4),t.mxI("ngModelChange",function(s){return t.DH7(o.filtroNombre,s)||(o.filtroNombre=s),s}),t.bIt("ngModelChange",function(){return o.aplicarFiltros()}),t.k0s()(),t.j41(12,"mat-form-field",3)(13,"mat-label"),t.EFF(14,"Apellido"),t.k0s(),t.j41(15,"input",4),t.mxI("ngModelChange",function(s){return t.DH7(o.filtroApellido,s)||(o.filtroApellido=s),s}),t.bIt("ngModelChange",function(){return o.aplicarFiltros()}),t.k0s()(),t.j41(16,"mat-form-field",3)(17,"mat-label"),t.EFF(18,"Edad"),t.k0s(),t.j41(19,"input",5),t.mxI("ngModelChange",function(s){return t.DH7(o.filtroEdad,s)||(o.filtroEdad=s),s}),t.bIt("ngModelChange",function(){return o.aplicarFiltros()}),t.k0s()(),t.j41(20,"mat-form-field",3)(21,"mat-label"),t.EFF(22,"Obra Social"),t.k0s(),t.j41(23,"input",4),t.mxI("ngModelChange",function(s){return t.DH7(o.filtroObra,s)||(o.filtroObra=s),s}),t.bIt("ngModelChange",function(){return o.aplicarFiltros()}),t.k0s()(),t.j41(24,"button",6),t.bIt("click",function(){return o.limpiarFiltros()}),t.EFF(25,"Limpiar"),t.k0s()(),t.j41(26,"div",7)(27,"table",8),t.qex(28,9),t.DNE(29,y,2,0,"th",10)(30,L,2,1,"td",11),t.bVm(),t.qex(31,12),t.DNE(32,M,2,0,"th",10)(33,D,2,1,"td",11),t.bVm(),t.qex(34,13),t.DNE(35,R,2,0,"th",10)(36,$,2,1,"td",11),t.bVm(),t.qex(37,14),t.DNE(38,G,2,0,"th",10)(39,H,2,1,"td",11),t.bVm(),t.qex(40,15),t.DNE(41,O,2,0,"th",10)(42,A,2,1,"td",11),t.bVm(),t.qex(43,16),t.DNE(44,B,2,0,"th",17)(45,w,4,0,"td",11),t.bVm(),t.DNE(46,U,1,0,"tr",18)(47,V,1,0,"tr",19),t.k0s(),t.nrm(48,"mat-paginator",20),t.k0s()()),2&n&&(t.R7$(11),t.R50("ngModel",o.filtroNombre),t.R7$(4),t.R50("ngModel",o.filtroApellido),t.R7$(4),t.R50("ngModel",o.filtroEdad),t.R7$(4),t.R50("ngModel",o.filtroObra),t.R7$(4),t.Y8G("dataSource",o.dataSource),t.R7$(19),t.Y8G("matHeaderRowDef",o.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",o.displayedColumns),t.R7$(),t.Y8G("pageSizeOptions",t.lJ4(8,N)))},dependencies:[r.me,r.Q0,r.BC,r.vS,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,g.fg,d.rl,d.nJ,f.$z,f.iY,T.An,E.iy,h.B4,h.aE,C.RN,S.KQ],styles:["[_nghost-%COMP%]{display:block}"]})}}return i})();var P=l(5416);const x=[{path:"",component:X},{path:"nuevo",component:(()=>{class i{constructor(e,n,o,a){this.fb=e,this.pacienteService=n,this.router=o,this.snack=a}ngOnInit(){this.form=this.fb.group({nombre:["",r.k0.required],apellido:["",r.k0.required],edad:[null,[r.k0.required,r.k0.min(0)]],dni:[""],obraSocial:[""],telefono:[""],email:["",r.k0.email],domicilio:[""]})}submit(){if(this.form.invalid)return this.form.markAllAsTouched(),void this.snack.open("Formulario inv\xe1lido. Completa los campos requeridos.","Cerrar",{duration:3e3});const e=this.form.value;console.log("Enviando createPaciente payload:",e),this.pacienteService.createPaciente(e).subscribe(()=>{console.log("Paciente creado correctamente"),this.snack.open("Paciente creado","Cerrar",{duration:2e3}),this.router.navigate(["/pacientes"])},n=>{console.error("Error al crear paciente:",n),this.snack.open(n?.error?.message||n?.message||"Error al crear paciente","Cerrar",{duration:5e3})})}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(r.ok),t.rXU(b),t.rXU(p.Ix),t.rXU(P.UG))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-paciente-form"]],decls:42,vars:1,consts:[[3,"ngSubmit","formGroup"],[2,"display","grid","grid-template-columns","repeat(auto-fit,minmax(240px,1fr))","gap","12px"],["appearance","fill"],["matInput","","formControlName","nombre"],["matInput","","formControlName","apellido"],["matInput","","type","number","formControlName","edad"],["matInput","","formControlName","dni"],["matInput","","formControlName","obraSocial"],["matInput","","formControlName","telefono"],["matInput","","formControlName","email"],["appearance","fill",1,"full"],["matInput","","formControlName","domicilio"],[2,"margin-top","12px"],["mat-flat-button","","color","primary","type","submit"],["mat-button","","type","button",3,"click"]],template:function(n,o){1&n&&(t.j41(0,"mat-card")(1,"h2"),t.EFF(2,"Nuevo Paciente"),t.k0s(),t.j41(3,"form",0),t.bIt("ngSubmit",function(){return o.submit()}),t.j41(4,"div",1)(5,"mat-form-field",2)(6,"mat-label"),t.EFF(7,"Nombre"),t.k0s(),t.nrm(8,"input",3),t.k0s(),t.j41(9,"mat-form-field",2)(10,"mat-label"),t.EFF(11,"Apellido"),t.k0s(),t.nrm(12,"input",4),t.k0s(),t.j41(13,"mat-form-field",2)(14,"mat-label"),t.EFF(15,"Edad"),t.k0s(),t.nrm(16,"input",5),t.k0s(),t.j41(17,"mat-form-field",2)(18,"mat-label"),t.EFF(19,"DNI"),t.k0s(),t.nrm(20,"input",6),t.k0s(),t.j41(21,"mat-form-field",2)(22,"mat-label"),t.EFF(23,"Obra Social"),t.k0s(),t.nrm(24,"input",7),t.k0s(),t.j41(25,"mat-form-field",2)(26,"mat-label"),t.EFF(27,"Tel\xe9fono"),t.k0s(),t.nrm(28,"input",8),t.k0s(),t.j41(29,"mat-form-field",2)(30,"mat-label"),t.EFF(31,"Email"),t.k0s(),t.nrm(32,"input",9),t.k0s(),t.j41(33,"mat-form-field",10)(34,"mat-label"),t.EFF(35,"Domicilio"),t.k0s(),t.nrm(36,"input",11),t.k0s()(),t.j41(37,"div",12)(38,"button",13),t.EFF(39,"Guardar"),t.k0s(),t.j41(40,"button",14),t.bIt("click",function(){return o.router.navigate(["/pacientes"])}),t.EFF(41,"Cancelar"),t.k0s()()()()),2&n&&(t.R7$(3),t.Y8G("formGroup",o.form))},dependencies:[r.qT,r.me,r.Q0,r.BC,r.cb,r.j4,r.JD,g.fg,d.rl,d.nJ,f.$z,C.RN],styles:["[_nghost-%COMP%]{display:block}"]})}}return i})()},{path:":id/historia",component:(()=>{class i{constructor(e,n,o,a,s){this.route=e,this.fb=n,this.pacienteService=o,this.snack=a,this.router=s}ngOnInit(){this.pacienteId=this.route.snapshot.paramMap.get("id")||"",this.form=this.fb.group({motivo:["",r.k0.required],diagnostico:[""],tratamiento:[""],observaciones:[""],fecha:[(new Date).toISOString().slice(0,10)]})}submit(){this.form.invalid||this.pacienteService.createHistoria(this.pacienteId,this.form.value).subscribe(()=>{this.snack.open("Historia guardada","Cerrar",{duration:2e3}),this.router.navigate(["/pacientes"])},e=>{this.snack.open("Error al guardar historia","Cerrar",{duration:3e3})})}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(p.nX),t.rXU(r.ok),t.rXU(b),t.rXU(P.UG),t.rXU(p.Ix))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-historia-form"]],decls:25,vars:1,consts:[[3,"ngSubmit","formGroup"],["appearance","fill",1,"full"],["matInput","","formControlName","motivo"],["matInput","","formControlName","diagnostico"],["matInput","","formControlName","tratamiento"],["matInput","","formControlName","observaciones"],[2,"margin-top","12px"],["mat-flat-button","","color","primary","type","submit"],["mat-button","","type","button",3,"click"]],template:function(n,o){1&n&&(t.j41(0,"mat-card")(1,"h2"),t.EFF(2,"Agregar Historia Cl\xednica"),t.k0s(),t.j41(3,"form",0),t.bIt("ngSubmit",function(){return o.submit()}),t.j41(4,"mat-form-field",1)(5,"mat-label"),t.EFF(6,"Motivo"),t.k0s(),t.nrm(7,"input",2),t.k0s(),t.j41(8,"mat-form-field",1)(9,"mat-label"),t.EFF(10,"Diagn\xf3stico"),t.k0s(),t.nrm(11,"textarea",3),t.k0s(),t.j41(12,"mat-form-field",1)(13,"mat-label"),t.EFF(14,"Tratamiento"),t.k0s(),t.nrm(15,"textarea",4),t.k0s(),t.j41(16,"mat-form-field",1)(17,"mat-label"),t.EFF(18,"Observaciones"),t.k0s(),t.nrm(19,"textarea",5),t.k0s(),t.j41(20,"div",6)(21,"button",7),t.EFF(22,"Guardar Historia"),t.k0s(),t.j41(23,"button",8),t.bIt("click",function(){return o.router.navigate(["/pacientes"])}),t.EFF(24,"Cancelar"),t.k0s()()()()),2&n&&(t.R7$(3),t.Y8G("formGroup",o.form))},dependencies:[r.qT,r.me,r.BC,r.cb,r.j4,r.JD,g.fg,d.rl,d.nJ,f.$z,C.RN],styles:["[_nghost-%COMP%]{display:block}"]})}}return i})()}];let J=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[p.iI.forChild(x),p.iI]})}}return i})();var z=l(5851);let Y=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[v.MD,r.X1,r.YN,J,z.G]})}}return i})()}}]);